
slowRequestPattern: "<%=scope.function_hiera('slowRequestPattern','*.html')%>"
slowRequestTimeout: <%=scope.function_hiera('slowRequestTimeout','1000')%>

server:

  applicationConnectors:
    - type: http
      port: 8080

  adminConnectors:
    - type: http
      port: 8081

  requestLog:

    appenders:

      - type: file

        # The file to which current statements will be logged.
        currentLogFilename: /var/log/apps/binary-writer-dw-access.log

        # When the log file rotates, the archived log will be renamed to this and gzipped. The
        # %d is replaced with the previous day (yyyy-MM-dd). Custom rolling windows can be created
        # by passing a SimpleDateFormat-compatible format as an argument: "%d{yyyy-MM-dd-hh}".
        archivedLogFilenamePattern: /var/log/apps/binary-writer-dw-access-%d.log.gz

        # The number of archived files to keep.
        archivedFileCount: 5

        # The timezone used to format dates. HINT: USE THE DEFAULT, UTC.
        timeZone: UTC

logging:

  level: <%=scope.function_hiera('loggingLevel','INFO')%>

  appenders:

      # ...
      # Settings for logging to a file.
      - type: file

        logFormat: "%-5p [%d{ISO8601, GMT}] %c: %X{transaction_id} %m [%thread]%n%xEx"
        # Do not write log statements below this threshold to the file.
        threshold: ALL

        # The file to which current statements will be logged.
        currentLogFilename: /var/log/apps/binary-writer-dw-app.log

        # When the log file rotates, the archived log will be renamed to this and gzipped. The
        # %d is replaced with the previous day (yyyy-MM-dd). Custom rolling windows can be created
        # by passing a SimpleDateFormat-compatible format as an argument: "%d{yyyy-MM-dd-hh}".
        archivedLogFilenamePattern: /var/log/apps/binary-writer-dw-app-%d.log.gz

        # The number of archived files to keep.
        archivedFileCount: 5

        # The timezone used to format dates. HINT: USE THE DEFAULT, UTC.
        timeZone: UTC

bucket: <%=scope.function_hiera('bucket', '')%>
credentialsPath: <%=scope.function_hiera('credentialsPath', '')%>

producerConfiguration:
  metadataBrokerList:
    <%=scope.function_hiera('metadataBrokerList','null')%>
  topicName: "BinaryPublicationEvents"
  timeout: 10000

kafkaHealthcheckParameters:
  name: "Can connect to Kafka"
  severity: 1
  businessImpact: "Content being published by journalists (images or other binary types) will not be accessible/reachable from the outside."
  technicalSummary: "Tests that Kafka responds with correct Topic"
  panicGuideUrl: "https://sites.google.com/a/ft.com/ft-technology-service-transition/home/run-book-library/image-binary-writer#TOC-TROUBLESHOOTING"
